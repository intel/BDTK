DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE, col_float DOUBLE);
INSERT INTO test VALUES (33,30,45.798050,null), (null,null,null,null), (38,39,null,23.991390), (null,null,null,null), (22,null,35.296555,null), (33,null,9.076531,10.768979), (29,null,19.130585,null), (6,null,3.337388,null), (null,18,null,null), (42,null,36.538635,null), (null,null,39.999866,null), (48,35,35.952469,4.876310), (1,16,15.225400,0.328229), (null,null,null,12.483722), (7,null,null,45.434643), (null,15,18.407820,21.994518), (43,17,40.390221,13.338809), (null,28,2.441262,37.409985), (null,null,43.880562,null), (31,34,null,11.143721), (8,49,18.442080,0.326645), (null,null,null,41.544388), (30,20,null,null), (40,5,27.357414,37.090405), (null,8,45.823254,22.133593), (null,null,32.765411,null), (41,6,null,11.536527), (49,null,null,38.092682), (14,null,null,25.413042), (36,28,4.422843,45.606197), (null,null,null,null), (null,null,28.346140,43.478970), (2,null,null,28.518608), (13,null,25.605869,null), (2,null,47.876965,null), (null,16,39.513332,18.909834), (49,null,0.010209,null), (null,null,48.578461,null), (null,null,37.438564,null), (37,14,null,45.205898), (null,null,null,8.543171), (null,null,null,null), (null,null,null,null), (null,null,40.842075,34.208248), (null,3,26.148272,null), (32,15,null,null), (0,null,48.897739,38.267891), (null,null,49.481407,null), (null,null,null,null), (18,12,null,49.279404), (null,null,null,null), (null,null,15.589438,null), (44,11,null,41.065918), (null,null,null,28.389656), (null,null,22.195095,null), (39,49,null,null), (null,44,10.376554,4.093257), (null,null,43.393036,null), (18,45,null,null), (35,null,null,33.278301), (null,45,28.959805,4.659661), (null,null,29.834343,49.986450), (null,null,46.962162,null), (null,50,5.209341,37.238159), (44,null,18.941099,22.686922), (null,50,null,18.047152), (29,null,null,18.274837), (1,22,7.012717,49.157967), (null,null,27.146694,null), (13,36,42.771046,26.269636), (46,null,null,null), (null,18,48.792660,null), (4,null,14.818619,null), (null,null,7.373354,null), (null,null,6.461210,null), (null,24,41.597332,null), (null,null,null,35.286247), (null,27,30.974865,14.282177), (36,11,33.850399,10.008545), (1,null,36.987202,23.989082), (50,null,5.319792,23.520723), (null,null,null,40.222618), (null,31,null,null), (null,null,36.994091,null), (null,32,null,34.879959), (null,12,null,null), (null,49,18.021622,16.143932), (null,null,23.403778,null), (null,null,null,39.416759), (null,50,null,21.496750), (45,null,44.115822,null), (null,null,null,null), (13,36,null,3.616234), (null,null,null,21.691607), (10,null,47.838589,null), (6,null,6.114610,null), (26,49,2.149976,null), (null,40,null,null), (7,48,null,23.078741), (null,24,null,17.260637) ;
select coalesce(COL_INT, COL_BIGINT, 7) from test;
select coalesce(COL_INT, COL_BIGINT, COL_DOUBLE) from test;
select sum(coalesce(COL_INT, COL_BIGINT, COL_DOUBLE, 7)) from test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE, col_float DOUBLE);
INSERT INTO test VALUES (null,4,4.149142,null), (null,null,2.098694,30.669413), (null,null,37.734531,null), (null,null,null,45.198807), (1,43,null,18.493303), (16,null,null,35.909115), (null,null,43.063648,23.222803), (null,null,null,null), (null,null,null,null), (null,null,null,null), (null,null,null,14.701170), (15,null,null,34.651722), (11,15,null,null), (null,null,null,16.615408), (40,9,null,5.740846), (39,null,27.645144,10.008286), (null,24,22.268700,null), (null,null,49.768543,null), (null,15,null,null), (13,3,null,2.716340), (null,24,9.640158,null), (33,null,36.162716,null), (1,null,4.248572,9.028241), (18,null,null,26.337152), (null,8,null,46.843849), (null,28,null,null), (14,null,37.750134,null), (20,null,2.560494,null), (null,8,0.129375,null), (6,9,26.376904,33.872879), (29,null,18.398710,18.293530), (null,12,12.793051,null), (12,null,null,6.853408), (7,21,3.634531,18.380156), (7,null,null,null), (null,null,21.294861,2.039131), (18,null,23.744143,26.050922), (null,null,null,27.256998), (4,42,4.045622,35.930885), (49,null,33.056900,null), (null,49,null,1.073532), (26,null,null,null), (34,null,45.868282,null), (null,26,null,null), (42,11,39.256359,null), (null,26,null,null), (null,23,null,17.731623), (null,33,null,25.812084), (null,44,null,42.408916), (9,15,1.961436,null), (null,8,null,4.523889), (null,31,6.564135,null), (null,null,4.564588,14.163274), (null,null,null,41.070683), (null,null,null,null), (29,null,23.596243,null), (17,25,null,null), (27,null,27.803782,null), (null,null,null,22.051788), (null,null,null,36.988686), (null,1,null,0.499937), (21,14,12.219276,null), (30,27,13.464448,null), (30,38,40.287563,42.753227), (34,41,null,3.294533), (null,31,null,3.626412), (null,20,null,null), (null,42,47.846977,33.665039), (24,null,null,29.832151), (null,7,14.071449,null), (40,null,22.962679,null), (null,7,null,35.308205), (null,null,null,1.760399), (null,null,6.553349,34.070747), (null,null,null,17.477152), (null,null,null,40.979488), (30,34,null,null), (null,37,47.897545,null), (8,null,1.908214,null), (35,4,null,null), (null,7,14.278454,null), (null,26,null,10.962897), (47,null,null,12.656663), (0,null,35.007629,10.625823), (5,null,null,7.451656), (null,null,null,39.765190), (17,13,26.076511,null), (null,40,12.419780,null), (null,null,49.378048,null), (null,null,15.162706,32.711102), (46,29,null,null), (48,11,2.796686,null), (null,48,21.899881,49.379051), (null,49,6.781337,25.822041), (34,43,null,null), (15,39,1.582711,37.286709), (1,null,null,null), (0,null,null,null), (43,44,null,null), (null,18,null,38.174427) ;
SELECT COALESCE(col_int, col_bigint, 777) FROM test;
SELECT COALESCE(col_int, col_double, 777) FROM test;
SELECT COALESCE(col_int, col_bigint, col_double, 777) FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE, col_float DOUBLE);
INSERT INTO test VALUES (null,null,3.394022,null), (null,39,43.398621,null), (null,44,43.319065,0.700657), (45,43,26.011637,null), (0,null,null,12.486558), (24,36,null,49.068779), (12,null,48.782890,18.571260), (null,null,26.979824,2.730620), (null,null,null,null), (48,null,null,26.968151), (4,null,null,null), (null,null,null,null), (42,34,25.334858,null), (null,null,null,45.033344), (null,null,5.989103,40.621315), (null,null,12.679940,null), (null,null,48.800972,null), (null,null,null,9.640562), (17,null,11.266895,37.734032), (40,1,35.339886,7.640494), (null,32,null,39.137302), (null,11,null,14.450058), (35,22,36.123322,null), (18,37,8.585013,null), (29,null,28.976122,null), (null,null,null,30.529982), (null,null,null,49.496113), (null,null,8.582340,null), (44,null,null,null), (null,null,40.336082,null), (22,null,3.010915,null), (50,null,32.871735,null), (null,null,1.003278,null), (2,19,36.679459,7.060645), (18,19,23.084656,25.947180), (1,null,34.267338,null), (46,null,25.419538,19.096058), (null,5,null,null), (42,35,5.174574,39.674351), (null,2,null,24.481049), (32,null,22.544050,null), (9,11,44.423637,null), (49,30,null,null), (17,35,null,null), (32,null,null,null), (7,0,null,20.560341), (null,28,4.679199,39.265190), (3,20,null,42.755039), (null,null,null,null), (null,32,null,33.466396), (null,42,48.777664,8.290930), (null,7,46.008701,4.514808), (null,null,11.478272,40.397701), (14,null,13.709955,49.134644), (0,46,null,29.242710), (null,null,null,null), (null,24,null,null), (21,null,null,null), (null,null,36.000961,15.555634), (null,null,31.861422,9.101682), (30,null,3.452656,null), (28,26,null,34.854183), (null,null,null,26.922316), (40,18,null,null), (null,10,33.419235,17.771179), (46,null,15.094915,null), (23,null,3.557798,null), (null,null,19.783997,null), (null,25,45.310471,40.820332), (null,null,null,46.727962), (47,31,null,20.997065), (null,null,19.975321,null), (19,null,null,null), (18,null,null,21.018181), (19,40,20.745920,null), (null,50,0.893755,30.763802), (null,null,null,null), (6,null,39.863731,null), (null,37,null,30.364605), (null,50,19.510160,40.082794), (17,11,null,null), (8,null,42.154331,null), (9,10,10.121116,null), (null,null,33.559570,null), (4,41,7.758303,null), (null,17,null,34.953617), (null,47,11.014982,null), (null,null,null,47.286369), (null,null,3.941370,null), (null,null,null,44.812592), (20,22,null,null), (null,null,8.562433,null), (2,24,null,null), (8,34,5.163189,null), (null,16,null,null), (null,16,35.197006,12.078808), (22,17,null,null), (39,20,18.823742,34.202351), (33,null,43.907772,null), (null,28,44.383305,41.085564) ;
SELECT COALESCE(col_double, col_int) FROM test;
SELECT COALESCE(col_int, col_double) FROM test;
SELECT COALESCE(col_int, col_bigint, col_double, col_float) FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE, col_float DOUBLE);
INSERT INTO test VALUES (24,4,9.566971,49.675785), (null,null,10.894040,null), (null,33,null,null), (null,null,43.940292,13.649723), (null,35,null,null), (22,9,null,null), (36,5,3.658424,32.223816), (null,null,22.218103,29.012589), (null,28,null,35.153309), (28,12,20.153019,9.963371), (null,null,null,44.143658), (null,21,32.360996,31.583729), (38,null,37.856869,null), (null,2,1.478215,null), (38,4,21.369524,null), (null,null,49.033401,null), (null,4,6.147685,6.253564), (50,17,26.872736,null), (2,null,41.748081,null), (null,null,null,null), (27,null,null,null), (null,null,null,null), (null,null,39.872139,null), (null,null,null,42.887180), (8,14,9.824228,21.749043), (null,4,1.606751,null), (7,10,28.360567,4.795034), (null,null,42.354660,null), (20,31,null,8.876296), (null,44,46.570698,null), (12,null,17.305113,12.015320), (null,7,null,16.526213), (29,null,1.847671,21.871458), (null,46,null,null), (null,4,22.790487,17.847403), (7,null,42.370461,32.701550), (15,null,null,null), (null,null,30.191093,null), (null,null,null,null), (null,null,40.731602,null), (22,34,null,22.800394), (null,null,null,20.768524), (7,null,32.496597,null), (36,null,null,null), (47,null,39.606571,null), (23,null,41.501705,38.196095), (null,null,3.731381,null), (45,34,null,11.399396), (24,45,null,null), (44,null,3.467176,null), (null,null,44.224434,null), (null,null,17.757381,40.562695), (49,42,null,null), (null,null,47.944923,null), (48,null,null,16.050438), (34,49,null,null), (null,50,null,null), (null,12,null,3.906289), (null,null,null,22.085554), (44,32,null,null), (null,5,37.499176,39.435421), (33,null,8.633350,2.632563), (null,null,null,22.530907), (null,46,null,null), (null,null,27.447653,11.984171), (31,null,null,null), (null,null,null,19.020996), (21,null,null,16.653776), (null,null,24.991114,21.928146), (41,null,13.882124,null), (null,null,null,27.645576), (2,7,null,11.829002), (null,null,6.588019,24.591738), (42,null,null,null), (3,null,null,9.151263), (6,7,30.815571,40.751163), (null,null,null,27.032406), (2,null,29.272131,null), (12,5,null,null), (null,11,12.245091,null), (null,null,18.149086,null), (7,null,null,1.468296), (null,null,29.279905,null), (37,18,13.902958,21.636259), (7,null,10.481007,null), (22,null,null,30.855814), (null,31,38.625751,16.101599), (null,16,null,null), (null,20,null,32.503979), (null,null,null,37.677834), (10,null,29.964048,null), (null,10,26.116631,6.910401), (35,null,35.191700,38.628216), (38,null,null,14.251417), (null,null,null,34.099182), (null,37,9.818947,null), (null,16,11.504759,null), (null,29,44.200626,48.509277), (null,null,null,null), (14,null,null,null) ;
SELECT count(COALESCE(col_double, 777)) FROM test;
SELECT sum(COALESCE(col_double, 777)) FROM test;
SELECT sum(COALESCE(col_int, col_bigint, col_double, 777)) FROM test;
SELECT sum(COALESCE(col_int, col_bigint, col_double)) FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE, col_float DOUBLE);
INSERT INTO test VALUES (42,29,null,null), (36,null,null,null), (1,47,null,null), (49,7,31.043663,null), (3,null,null,7.990465), (null,null,19.967419,16.388779), (20,null,0.428413,null), (10,null,24.143038,38.220802), (9,33,1.690064,null), (null,30,null,null), (38,25,17.421589,null), (14,null,16.696354,null), (25,null,null,3.798621), (null,null,null,42.016628), (3,null,null,null), (null,39,18.945688,41.448734), (null,null,null,null), (null,null,17.115763,40.931408), (null,null,null,46.430676), (40,28,null,null), (48,null,48.095322,27.972523), (null,null,6.413703,null), (40,null,28.538460,null), (null,39,16.853281,1.733420), (null,46,null,null), (null,null,32.536674,null), (null,37,29.870411,9.085593), (31,null,null,null), (6,16,15.190675,null), (null,null,null,39.405960), (13,33,22.900364,null), (null,22,47.885036,null), (38,null,36.984192,26.334486), (41,null,null,39.718044), (9,6,41.047070,null), (null,null,null,19.202345), (null,null,1.909417,null), (null,null,null,null), (null,null,43.701916,45.813721), (null,10,null,35.529755), (null,33,null,49.978352), (29,null,39.493370,null), (5,18,11.311186,null), (8,null,null,null), (null,46,null,null), (43,null,null,null), (null,25,9.850255,null), (null,null,null,20.360468), (null,39,null,null), (null,null,46.982567,null), (31,null,null,null), (14,15,null,null), (16,10,5.889569,41.386883), (28,null,43.205338,7.877032), (8,48,49.771969,26.991161), (43,null,14.998976,null), (null,4,34.465382,15.314402), (19,7,43.997055,21.632963), (40,null,24.123047,null), (34,null,40.955181,45.977997), (null,28,null,25.950523), (null,null,null,1.905983), (null,25,22.752495,15.194018), (null,null,null,null), (34,5,48.953239,24.515850), (null,45,4.291309,38.448559), (35,null,30.041548,43.142212), (null,25,null,12.855990), (null,30,null,null), (27,null,15.487864,27.182463), (null,null,5.013029,14.102839), (44,19,null,null), (49,null,null,null), (null,null,null,13.618900), (9,24,null,29.573870), (24,null,null,8.204535), (34,null,null,5.723253), (null,null,null,null), (null,11,null,24.488880), (null,49,35.325123,28.880087), (null,4,49.905483,1.829724), (41,17,22.025366,30.079321), (26,14,48.517574,19.646786), (null,null,34.314423,5.796518), (null,null,null,42.915459), (null,null,15.937013,null), (null,null,39.208023,37.570686), (null,null,null,5.642716), (6,null,null,23.914598), (19,null,null,null), (12,20,null,null), (9,44,35.508179,null), (50,null,3.953266,null), (null,null,null,45.971127), (null,null,null,null), (null,35,null,2.051445), (null,null,17.211241,34.981411), (null,null,47.490372,null), (null,null,28.996313,null), (11,11,null,null) ;
SELECT col_int, CASE WHEN col_int > 3 THEN 1 ELSE 0 END FROM test;
SELECT col_int, CASE WHEN col_bigint < 9 THEN 2 ELSE 1 END FROM test;
SELECT col_bigint, CASE WHEN col_double > 5 THEN 3 ELSE 2 END FROM test;
SELECT col_double, CASE WHEN col_int > 5 THEN 4 ELSE 3 END FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE, col_float DOUBLE);
INSERT INTO test VALUES (48,2,11.258040,2.459508), (3,17,null,null), (18,36,23.828531,null), (null,null,40.034897,null), (null,12,23.169197,39.934406), (null,null,33.509228,null), (9,13,7.672924,36.558884), (33,null,22.604761,null), (0,50,36.503105,null), (null,null,15.895870,null), (20,null,null,null), (50,null,9.234752,24.302839), (23,14,35.242710,47.824348), (32,19,47.859852,null), (null,43,3.566753,6.816325), (null,7,null,null), (15,28,0.242824,null), (28,null,41.501190,null), (44,null,29.832067,null), (null,null,22.727615,24.756884), (28,null,null,33.795376), (50,null,null,null), (9,null,null,null), (17,null,null,null), (null,null,null,null), (15,null,13.423880,31.794888), (null,null,null,8.333921), (13,48,null,18.101362), (34,null,null,null), (null,46,1.096666,31.051027), (24,null,35.201694,39.024673), (null,null,null,8.186958), (null,null,47.390343,4.013824), (null,36,30.801409,13.209216), (null,29,38.338642,null), (null,null,6.813917,48.209229), (24,null,37.729431,null), (null,39,29.056654,null), (1,null,null,null), (null,null,null,null), (null,44,null,null), (32,null,3.508759,null), (42,null,null,null), (4,null,36.571770,null), (null,null,1.851992,47.538448), (34,null,18.397751,40.353596), (34,null,3.828412,21.715399), (null,48,7.869522,19.861252), (20,26,13.271337,null), (25,49,26.829046,null), (47,null,41.661026,28.721962), (35,33,21.376930,9.688780), (46,null,33.153152,null), (null,19,null,null), (1,null,32.048328,null), (null,9,null,0.915012), (null,null,0.394964,null), (null,42,null,22.383688), (null,1,7.478288,13.635961), (40,null,null,37.342503), (49,1,null,17.239237), (null,null,38.975979,31.763273), (21,40,null,1.559672), (null,18,38.568508,10.150688), (29,null,null,null), (29,6,5.665397,null), (25,28,null,26.902586), (null,12,48.082333,null), (null,null,null,null), (null,0,null,null), (null,null,47.607868,0.157976), (23,null,null,null), (null,null,19.020529,15.887435), (42,7,10.605516,null), (null,null,null,4.950583), (10,36,null,26.225409), (27,21,35.137600,null), (null,null,46.553619,null), (33,null,6.739512,21.789995), (null,null,48.564461,null), (30,47,null,null), (null,null,null,null), (null,32,null,null), (16,null,null,7.301687), (43,8,20.420660,30.680027), (30,null,44.752853,null), (0,null,null,null), (null,null,null,35.632233), (29,null,13.964767,null), (null,null,null,null), (39,19,9.538464,3.641638), (31,13,null,43.677872), (38,25,14.562197,null), (null,18,null,8.736064), (42,null,5.653635,null), (null,47,9.898151,26.755402), (44,9,null,null), (null,42,null,null), (null,8,11.377388,26.058418), (28,23,40.450104,30.753862) ;
SELECT col_int, CASE WHEN col_int > 30 THEN 1 ELSE 0 END FROM test;
SELECT col_bigint, CASE WHEN col_double > 50 THEN 3 ELSE 2 END FROM test;
SELECT SUM(CASE WHEN col_int >50 THEN 10 ELSE 1 END) FROM test;
SELECT SUM(CASE WHEN col_bigint < 30 THEN 10 WHEN col_bigint > 70 THEN 20 WHEN col_bigint = 50 THEN 30 ELSE 1 END) FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE, col_float DOUBLE);
INSERT INTO test VALUES (null,11,14.289745,26.724258), (21,null,null,null), (47,39,15.709927,null), (19,29,32.029602,null), (36,null,null,39.122009), (null,48,4.918399,null), (47,null,null,7.296844), (35,null,null,7.540510), (5,null,20.143007,null), (null,null,null,36.403950), (6,19,null,null), (null,null,null,null), (null,null,32.046837,12.232059), (8,null,14.129538,30.156391), (null,48,5.209776,25.444239), (null,null,37.429241,null), (null,7,null,19.045240), (6,42,null,43.626347), (4,null,null,28.607147), (null,null,31.362864,47.391880), (2,5,null,43.687222), (null,null,4.306047,21.132978), (14,1,39.104290,null), (29,18,null,22.087673), (43,44,48.742744,39.855293), (null,14,20.857290,29.442835), (null,39,6.157211,24.783600), (22,39,17.953014,null), (4,null,21.704111,4.913194), (null,47,null,null), (40,34,null,null), (null,null,null,null), (46,null,21.203447,null), (15,5,null,null), (26,35,33.912106,null), (6,14,null,null), (null,null,12.381388,2.921818), (null,null,18.181971,49.828415), (17,3,42.061325,null), (0,13,6.731531,null), (43,34,45.973095,40.644798), (49,null,null,41.970428), (null,null,9.173000,21.936497), (null,28,21.412992,20.797735), (null,50,null,7.862123), (41,45,44.080074,14.704958), (37,null,45.008175,45.899563), (null,40,null,21.610352), (10,null,48.316677,28.450993), (null,6,2.976141,null), (32,null,null,null), (null,null,26.292778,33.133415), (14,null,19.259752,null), (null,3,3.815271,40.779297), (0,47,34.389542,null), (36,null,null,30.350954), (null,null,null,null), (null,null,35.024338,0.968680), (25,35,null,18.910990), (null,42,null,31.629705), (null,null,41.712280,null), (null,null,39.834412,null), (30,13,null,42.287643), (null,null,35.729599,46.665955), (8,4,null,38.827038), (null,25,null,null), (null,null,null,null), (null,13,null,null), (21,46,8.659269,null), (17,1,null,null), (null,null,null,null), (40,null,0.587580,null), (14,1,null,null), (null,null,16.884939,null), (null,8,null,null), (null,null,16.727119,49.227905), (2,47,9.603452,null), (null,null,null,31.444084), (50,3,9.695068,null), (19,null,16.584215,46.125824), (23,44,null,null), (null,40,27.430534,29.947445), (35,28,35.644108,19.831091), (null,46,null,null), (null,null,4.712479,null), (23,null,11.306660,3.841445), (50,null,null,15.415308), (35,null,null,null), (null,14,null,7.729290), (null,38,14.701244,39.953022), (48,38,22.345028,26.798483), (12,23,10.346169,null), (null,28,47.115757,null), (null,23,null,null), (null,null,9.112082,12.926825), (4,19,29.487240,null), (11,39,21.442158,null), (null,null,23.413744,null), (13,32,35.046593,null), (null,49,13.564160,25.966120) ;
SELECT col_int, CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 ELSE 0 END FROM test;
SELECT col_int, CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 WHEN col_int=3 THEN 30 ELSE 0 END FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE, col_float DOUBLE);
INSERT INTO test VALUES (null,41,null,null), (38,null,15.744175,5.032778), (null,null,9.329481,null), (32,44,13.810909,0.507027), (45,43,42.600685,null), (8,null,null,null), (null,null,null,5.136731), (26,32,33.219193,26.348785), (43,32,41.090023,11.329843), (null,null,null,null), (null,null,28.608223,null), (null,null,23.401478,20.144587), (null,1,null,null), (44,40,3.354522,6.559049), (null,48,null,3.636824), (null,null,19.215977,29.370514), (null,33,null,null), (null,null,null,17.580029), (24,36,null,null), (null,null,37.645443,19.043116), (null,null,null,32.446175), (null,null,null,27.366451), (19,null,12.371449,null), (31,30,46.265022,29.639153), (31,3,33.711765,1.064710), (16,30,null,28.462595), (null,37,null,null), (null,null,34.382072,43.925018), (null,42,null,1.060693), (null,39,0.091908,null), (16,null,null,35.491138), (null,null,null,6.359401), (null,null,44.184731,30.243530), (26,29,26.169804,24.855742), (29,45,null,18.937431), (24,24,null,31.553862), (null,null,18.560455,24.319736), (null,null,32.334454,26.213221), (28,null,null,null), (null,19,48.716637,null), (16,4,null,47.491203), (48,null,14.315414,null), (null,14,16.671591,26.010811), (22,2,37.482059,null), (null,44,null,45.032940), (44,38,12.636326,43.368130), (14,43,null,16.481955), (null,null,6.034431,46.827957), (4,null,null,null), (32,42,null,42.196892), (null,49,null,4.798042), (null,16,null,19.985987), (33,27,null,null), (30,18,null,23.325363), (null,25,null,36.838024), (20,null,36.224590,11.873026), (0,null,31.236795,17.328552), (null,null,null,null), (null,null,12.097826,null), (null,null,47.021755,null), (27,50,40.990005,null), (null,43,1.744943,null), (null,null,32.739525,47.994320), (null,null,null,null), (null,31,49.178810,35.774658), (14,null,null,null), (1,null,null,null), (null,null,2.446398,null), (32,30,33.990925,23.862247), (19,11,4.523886,null), (null,null,0.492965,8.628659), (14,null,null,35.277210), (1,null,null,null), (24,null,null,49.146767), (null,null,null,29.379076), (35,50,null,null), (null,7,45.239204,null), (null,15,null,null), (50,24,0.717882,null), (null,14,22.798931,23.008402), (null,30,null,null), (33,null,null,32.107971), (34,null,null,null), (null,9,43.231209,null), (null,46,null,null), (23,null,40.765568,42.357437), (34,null,9.462094,null), (null,null,null,null), (21,18,null,15.009832), (42,2,0.013966,30.386457), (null,34,6.862172,null), (48,45,null,null), (4,null,47.491722,48.687595), (31,41,49.302471,null), (null,26,1.843121,null), (null,null,38.831364,45.277351), (null,null,null,null), (null,null,null,40.204460), (null,40,46.946247,17.333927), (null,42,44.621124,20.201427) ;
SELECT SUM(CASE WHEN col_int=1 THEN 10 ELSE 1 END) FROM test;
SELECT SUM(CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 WHEN col_int=3 THEN 30 ELSE 1 END) FROM test;
SELECT SUM(CASE WHEN col_int=3 THEN 11 ELSE 2 END), SUM(CASE WHEN col_double=3 THEN 12 ELSE 3 END) FROM test;
SELECT SUM(CASE WHEN col_int < 10 THEN 11 END), SUM(CASE WHEN col_double > 10 THEN 12 END) FROM test;
SELECT SUM(CASE col_int WHEN 3 THEN 11 ELSE 2 END), SUM(CASE col_double WHEN 3 THEN 12 ELSE 3 END) FROM test;
SELECT SUM(CASE WHEN col_int > 5 THEN 4 ELSE 3 END), CASE WHEN col_int > 5 THEN 4 ELSE 3 END FROM test GROUP BY CASE WHEN col_int > 5 THEN 4 ELSE 3 END;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE);
INSERT INTO test VALUES (0,0,0.000000), (1,1,1.000000), (2,2,2.000000), (3,3,3.000000), (4,4,4.000000), (5,5,5.000000), (6,6,6.000000), (7,7,7.000000), (8,8,8.000000), (9,9,9.000000) ;
SELECT col_int, CASE WHEN col_int > 3 THEN 1 ELSE 0 END FROM test;
SELECT col_int, CASE WHEN col_bigint < 9 THEN 2 ELSE 1 END FROM test;
SELECT col_bigint, CASE WHEN col_double > 5 THEN 3 ELSE 2 END FROM test;
SELECT col_double, CASE WHEN col_int > 5 THEN 4 ELSE 3 END FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE);
INSERT INTO test VALUES (0,0,0.000000), (1,1,1.000000), (2,2,2.000000), (3,3,3.000000), (4,4,4.000000), (5,5,5.000000), (6,6,6.000000), (7,7,7.000000), (8,8,8.000000), (9,9,9.000000) ;
SELECT col_int, CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 ELSE 0 END FROM test;
SELECT col_int, CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 WHEN col_int=3 THEN 30 ELSE 0 END FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE);
INSERT INTO test VALUES (0,0,0.000000), (1,1,1.000000), (2,2,2.000000), (3,3,3.000000), (4,4,4.000000), (5,5,5.000000), (6,6,6.000000), (7,7,7.000000), (8,8,8.000000), (9,9,9.000000) ;
SELECT col_int, CASE WHEN col_int=1 THEN 10 END FROM test;
SELECT col_int, CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 WHEN col_int=3 THEN 30 END FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE);
INSERT INTO test VALUES (0,0,0.000000), (1,1,1.000000), (2,2,2.000000), (3,3,3.000000), (4,4,4.000000), (5,5,5.000000), (6,6,6.000000), (7,7,7.000000), (8,8,8.000000), (9,9,9.000000) ;
SELECT SUM(CASE WHEN col_int=1 THEN 10 ELSE 1 END) FROM test;
SELECT SUM(CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 WHEN col_int=3 THEN 30 ELSE 1 END) FROM test;
SELECT SUM(CASE WHEN col_int=3 THEN 11 ELSE 2 END), SUM(CASE WHEN col_double=3 THEN 12 ELSE 3 END) FROM test;
SELECT SUM(CASE col_int WHEN 3 THEN 11 ELSE 2 END), SUM(CASE col_double WHEN 3 THEN 12 ELSE 3 END) FROM test;
SELECT sum(col_double), CASE WHEN col_int > 5 THEN 4 ELSE 3 END FROM test GROUP BY CASE WHEN col_int > 5 THEN 4 ELSE 3 END;
SELECT sum(col_double), col_bigint, CASE WHEN col_int > 5 THEN 4 ELSE 3 END FROM test GROUP BY col_bigint, (CASE WHEN col_int > 5 THEN 4 ELSE 3 END);
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE);
INSERT INTO test VALUES (0,null,0.000000), (1,1,1.000000), (2,2,2.000000), (null,3,3.000000), (4,null,null), (5,null,5.000000), (6,6,6.000000), (7,null,7.000000), (8,8,8.000000), (null,9,9.000000), (null,10,null), (11,null,null), (null,null,12.000000), (13,13,13.000000), (null,14,14.000000), (15,15,15.000000), (16,16,16.000000), (17,17,null), (18,18,18.000000), (19,19,19.000000), (20,20,20.000000), (21,21,21.000000), (22,22,null), (23,23,23.000000), (24,24,24.000000), (null,null,null), (26,26,26.000000), (27,27,27.000000), (null,null,28.000000), (null,null,null), (30,30,30.000000), (31,31,31.000000), (null,null,32.000000), (33,33,33.000000), (null,null,34.000000), (35,35,35.000000), (36,36,36.000000), (null,null,37.000000), (38,null,38.000000), (39,39,null), (40,40,40.000000), (41,41,41.000000), (null,42,42.000000), (43,43,43.000000), (44,null,44.000000), (45,45,45.000000), (null,null,46.000000), (47,null,47.000000), (48,48,48.000000), (null,49,49.000000), (null,50,null), (51,null,51.000000), (52,null,null), (53,53,53.000000), (54,54,54.000000), (55,55,55.000000), (56,56,56.000000), (57,57,null), (null,null,null), (59,59,59.000000), (60,60,null), (61,61,null), (62,null,62.000000), (null,null,63.000000), (64,64,64.000000), (65,65,65.000000), (66,null,66.000000), (null,67,null), (null,68,68.000000), (null,69,69.000000), (70,70,70.000000), (71,71,71.000000), (72,null,72.000000), (73,73,null), (null,74,null), (75,75,75.000000), (76,76,null), (null,null,null), (null,78,78.000000), (null,79,null), (null,80,null), (null,81,null), (82,null,null), (83,83,83.000000), (84,84,null), (85,85,85.000000), (86,86,null), (87,87,87.000000), (null,88,88.000000), (null,89,89.000000), (90,90,90.000000), (91,91,null), (null,92,92.000000), (93,null,93.000000), (94,94,94.000000), (95,95,95.000000), (null,null,96.000000), (null,null,97.000000), (98,98,null), (99,99,null) ;
SELECT col_int, CASE WHEN col_int > 3 THEN 1 ELSE 0 END FROM test;
SELECT col_int, CASE WHEN col_bigint < 9 THEN 2 ELSE 1 END FROM test;
SELECT col_bigint, CASE WHEN col_double > 5 THEN 3 ELSE 2 END FROM test;
SELECT col_double, CASE WHEN col_int > 5 THEN 4 ELSE 3 END FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE);
INSERT INTO test VALUES (null,0,null), (null,1,1.000000), (null,null,null), (3,3,3.000000), (4,4,4.000000), (5,5,5.000000), (6,null,6.000000), (null,7,null), (8,null,null), (null,9,9.000000), (10,10,null), (11,null,null), (12,null,12.000000), (13,13,13.000000), (14,null,14.000000), (null,15,15.000000), (16,16,null), (null,17,17.000000), (18,null,null), (null,19,19.000000), (20,20,null), (21,null,21.000000), (22,22,null), (23,null,23.000000), (24,24,24.000000), (25,null,25.000000), (26,null,26.000000), (null,null,27.000000), (28,null,null), (null,null,29.000000), (30,null,30.000000), (31,31,null), (32,32,32.000000), (33,33,33.000000), (34,null,34.000000), (null,35,null), (36,36,36.000000), (37,37,null), (null,null,38.000000), (39,null,39.000000), (40,40,40.000000), (41,41,41.000000), (42,null,42.000000), (null,null,43.000000), (44,44,null), (45,45,45.000000), (null,null,46.000000), (47,47,47.000000), (null,48,null), (null,49,49.000000), (null,50,50.000000), (51,51,null), (52,null,52.000000), (53,null,53.000000), (54,54,54.000000), (55,null,null), (null,56,null), (57,null,null), (58,58,null), (59,null,59.000000), (null,null,null), (61,61,null), (62,null,null), (63,63,null), (null,64,null), (null,65,null), (66,66,null), (67,67,67.000000), (68,null,68.000000), (69,69,null), (70,null,70.000000), (71,71,71.000000), (null,72,72.000000), (null,73,73.000000), (74,74,74.000000), (75,75,75.000000), (null,76,76.000000), (77,77,null), (78,78,78.000000), (null,null,79.000000), (null,null,80.000000), (81,81,null), (82,82,82.000000), (83,83,null), (84,null,84.000000), (85,null,85.000000), (null,86,86.000000), (87,87,87.000000), (88,88,88.000000), (89,89,89.000000), (null,90,90.000000), (91,91,null), (92,92,92.000000), (93,93,93.000000), (null,null,94.000000), (null,null,95.000000), (96,null,96.000000), (null,97,97.000000), (98,98,98.000000), (99,99,99.000000) ;
SELECT col_int, CASE WHEN col_int > 30 THEN 1 ELSE 0 END FROM test;
SELECT col_bigint, CASE WHEN col_double > 50 THEN 3 ELSE 2 END FROM test;
SELECT SUM(CASE WHEN col_int >50 THEN 10 ELSE 1 END) FROM test;
SELECT SUM(CASE WHEN col_bigint < 30 THEN 10 WHEN col_bigint > 70 THEN 20 WHEN col_bigint = 50 THEN 30 ELSE 1 END) FROM test;
DROP TABLE iF EXISTS test;
CREATE TABLE test(col_int INTEGER, col_bigint BIGINT, col_double DOUBLE);
INSERT INTO test VALUES (0,0,null), (null,1,null), (2,2,2.000000), (3,null,null), (4,4,4.000000), (5,5,null), (6,6,null), (null,7,7.000000), (null,8,8.000000), (null,9,9.000000), (10,null,null), (11,null,11.000000), (12,12,12.000000), (13,13,13.000000), (14,null,null), (15,15,15.000000), (null,null,16.000000), (null,17,17.000000), (18,18,18.000000), (19,19,19.000000), (20,20,null), (21,null,21.000000), (null,22,22.000000), (null,23,null), (null,null,24.000000), (25,25,null), (26,26,26.000000), (27,27,27.000000), (null,28,28.000000), (29,29,null), (null,30,30.000000), (null,null,31.000000), (32,null,null), (null,33,null), (34,null,34.000000), (35,35,35.000000), (36,36,36.000000), (null,null,37.000000), (38,38,null), (39,null,null), (40,40,40.000000), (41,null,null), (42,null,null), (43,null,43.000000), (44,44,44.000000), (45,45,45.000000), (46,null,46.000000), (47,null,null), (48,null,48.000000), (49,49,null), (50,50,50.000000), (null,51,51.000000), (52,null,52.000000), (53,null,53.000000), (54,null,54.000000), (55,55,55.000000), (56,null,null), (57,57,57.000000), (58,null,null), (59,null,59.000000), (null,60,null), (61,61,61.000000), (62,62,62.000000), (null,null,63.000000), (64,null,64.000000), (65,65,null), (null,66,66.000000), (67,67,67.000000), (null,null,null), (69,null,69.000000), (null,70,null), (null,null,null), (72,72,72.000000), (null,null,73.000000), (74,74,74.000000), (75,null,null), (76,null,76.000000), (77,77,77.000000), (78,78,78.000000), (null,null,null), (80,null,80.000000), (81,81,81.000000), (82,82,82.000000), (null,83,83.000000), (84,null,84.000000), (null,85,null), (86,86,86.000000), (87,null,87.000000), (null,88,null), (89,89,null), (null,null,null), (91,91,null), (null,92,null), (null,93,93.000000), (94,null,94.000000), (95,95,null), (96,null,null), (97,null,97.000000), (98,98,98.000000), (99,null,99.000000) ;
SELECT col_int, CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 ELSE 0 END FROM test;
SELECT col_int, CASE WHEN col_int=1 THEN 10 WHEN col_int=2 THEN 20 WHEN col_int=3 THEN 30 ELSE 0 END FROM test;
